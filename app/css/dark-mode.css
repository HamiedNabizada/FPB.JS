/* Dark Mode Theme System for FPB.js */

:root {
  /* Light Theme Colors */
  --fpb-bg-primary: #ffffff;
  --fpb-bg-secondary: #FAFAFA;
  --fpb-bg-canvas: #ffffff;
  --fpb-border-color: #CCC;
  --fpb-text-primary: #333333;
  --fpb-text-secondary: #666666;
  --fpb-text-muted: #999999;
  
  /* Panel backgrounds */
  --fpb-panel-bg: #FAFAFA;
  --fpb-panel-border: #CCC;
  
  /* Tooltip colors */
  --fpb-tooltip-bg: #000000;
  --fpb-tooltip-text: #ffffff;
  
  /* Button and interaction colors */
  --fpb-button-bg: #ffffff;
  --fpb-button-border: #ccc;
  --fpb-button-hover: #f5f5f5;
  
  /* Selection colors */
  --fpb-selection-border: #d53032;
  
  /* Card and modal backgrounds */
  --fpb-card-bg: #ffffff;
  --fpb-modal-bg: #ffffff;
  --fpb-input-bg: #ffffff;
  --fpb-input-border: #ccc;
}

/* Dark Theme */
[data-theme="dark"] {
  /* Dark Theme Colors */
  --fpb-bg-primary: #1a1a1a;
  --fpb-bg-secondary: #2d2d2d;
  --fpb-bg-canvas: #2d2d2d;
  --fpb-border-color: #404040;
  --fpb-text-primary: #e0e0e0;
  --fpb-text-secondary: #b0b0b0;
  --fpb-text-muted: #808080;
  
  /* Panel backgrounds */
  --fpb-panel-bg: #2d2d2d;
  --fpb-panel-border: #404040;
  
  /* Tooltip colors */
  --fpb-tooltip-bg: #444444;
  --fpb-tooltip-text: #ffffff;
  
  /* Button and interaction colors */
  --fpb-button-bg: #3a3a3a;
  --fpb-button-border: #555555;
  --fpb-button-hover: #4a4a4a;
  
  /* Selection colors */
  --fpb-selection-border: #ff6b6d;
  
  /* Card and modal backgrounds */
  --fpb-card-bg: #3a3a3a;
  --fpb-modal-bg: #2d2d2d;
  --fpb-input-bg: #3a3a3a;
  --fpb-input-border: #555555;
}

/* Apply theme variables to existing elements */

/* Body and main containers */
body {
  background-color: var(--fpb-bg-primary);
  color: var(--fpb-text-primary);
  transition: background-color 0.3s ease, color 0.3s ease;
}

.fpb-wrapper {
  background-color: var(--fpb-bg-primary);
}

/* Canvas background */
#modeler-container,
.djs-container {
  background-color: var(--fpb-bg-canvas) !important;
}

/* Panels */
#properties-container,
#layer-container {
  background: var(--fpb-panel-bg) !important;
  border-left: solid 1px var(--fpb-panel-border) !important;
  color: var(--fpb-text-primary);
}

/* Tooltips */
.tooltiptext {
  background-color: var(--fpb-tooltip-bg) !important;
  color: var(--fpb-tooltip-text) !important;
}

/* Borders */
.oneline {
  border: solid 1px var(--fpb-button-border) !important;
  color: var(--fpb-text-primary);
}

.oneline-selected {
  border: solid 1px var(--fpb-selection-border) !important;
  color: var(--fpb-text-primary);
}

/* Bootstrap overrides for dark mode */
[data-theme="dark"] .modal-content {
  background-color: var(--fpb-modal-bg);
  color: var(--fpb-text-primary);
}

[data-theme="dark"] .card {
  background-color: var(--fpb-card-bg);
  border-color: var(--fpb-border-color);
  color: var(--fpb-text-primary);
}

[data-theme="dark"] .form-control {
  background-color: var(--fpb-input-bg);
  border-color: var(--fpb-input-border);
  color: var(--fpb-text-primary);
}

[data-theme="dark"] .form-control:focus {
  background-color: var(--fpb-input-bg);
  border-color: var(--fpb-selection-border);
  color: var(--fpb-text-primary);
}

[data-theme="dark"] .form-control::placeholder {
  color: var(--fpb-text-muted);
  opacity: 0.8;
}

[data-theme="dark"] input::placeholder {
  color: var(--fpb-text-muted);
  opacity: 0.8;
}

/* InfoModal specific dark mode styling */
[data-theme="dark"] .modal-content .text-dark {
  color: var(--fpb-text-primary) !important;
}

[data-theme="dark"] .modal-content .text-muted {
  color: var(--fpb-text-secondary) !important;
}

[data-theme="dark"] .modal-content p.text-muted {
  color: var(--fpb-text-secondary) !important;
}

[data-theme="dark"] .modal-content .bg-light {
  background-color: var(--fpb-button-hover) !important;
}

[data-theme="dark"] .modal-content .table {
  color: var(--fpb-text-primary);
}

[data-theme="dark"] .modal-content .table th {
  background-color: var(--fpb-bg-secondary);
  color: var(--fpb-text-primary);
  border-color: var(--fpb-border-color);
}

[data-theme="dark"] .modal-content .table td {
  background-color: var(--fpb-bg-primary);
  color: var(--fpb-text-primary);
  border-color: var(--fpb-border-color);
}

[data-theme="dark"] .modal-content .table-striped tbody tr:nth-of-type(odd) td {
  background-color: var(--fpb-bg-secondary);
}

[data-theme="dark"] .modal-content .badge {
  background-color: var(--fpb-button-bg) !important;
  color: var(--fpb-text-primary);
}

[data-theme="dark"] .modal-content a {
  color: var(--fpb-text-primary);
}

[data-theme="dark"] .modal-content a:hover {
  color: #ffffff;
}

[data-theme="dark"] .btn {
  background-color: var(--fpb-button-bg);
  border-color: var(--fpb-button-border);
  color: var(--fpb-text-primary);
}

[data-theme="dark"] .btn:hover {
  background-color: var(--fpb-button-hover);
  color: var(--fpb-text-primary);
}


/* Smooth transitions for theme switching */
* {
  transition: background-color 0.3s ease, 
              border-color 0.3s ease, 
              color 0.3s ease;
}

/* Diagram-js specific dark mode adjustments */
[data-theme="dark"] .djs-palette {
  background: var(--fpb-panel-bg);
  border-color: var(--fpb-border-color);
}

[data-theme="dark"] .djs-palette .entry {
  color: var(--fpb-text-primary);
}

[data-theme="dark"] .djs-palette .entry:hover {
  background: var(--fpb-button-hover);
}

[data-theme="dark"] .djs-context-pad {
  background: var(--fpb-panel-bg);
  border-color: var(--fpb-border-color);
}

[data-theme="dark"] .djs-context-pad .entry:hover {
  background: var(--fpb-button-hover);
}

/* SVG Canvas and Elements Dark Mode */
[data-theme="dark"] .djs-container svg {
  background: var(--fpb-bg-canvas) !important;
}

[data-theme="dark"] .viewport {
  background: var(--fpb-bg-canvas) !important;
}

/* Preview and drag elements */
[data-theme="dark"] .djs-drag-preview {
  background: var(--fpb-bg-canvas) !important;
}

[data-theme="dark"] .djs-shape {
  background: var(--fpb-bg-canvas) !important;
}

/* Temporary/preview shapes during drag */
[data-theme="dark"] .djs-dragger {
  background: var(--fpb-bg-canvas) !important;
}

[data-theme="dark"] .djs-dragger .djs-visual {
  background: var(--fpb-bg-canvas) !important;
}

/* Don't override element fills - only target specific cases if needed */

/* Canvas background via SVG */
[data-theme="dark"] .djs-container .viewport {
  background-color: var(--fpb-bg-canvas) !important;
}

/* Drag ghost elements */
[data-theme="dark"] .djs-overlay {
  background: var(--fpb-bg-canvas) !important;
}

/* Make sure dragged elements have dark background */
[data-theme="dark"] .djs-drag-group {
  background: var(--fpb-bg-canvas) !important;
}

[data-theme="dark"] .djs-drag-group rect {
  fill: var(--fpb-bg-canvas) !important;
}

/* Selection and hover overlays */
[data-theme="dark"] .djs-outline,
[data-theme="dark"] .djs-selection-outline {
  stroke: var(--fpb-selection-border) !important;
}

[data-theme="dark"] .djs-selection-outline {
  fill: none !important;
}

[data-theme="dark"] .hover {
  stroke: var(--fpb-text-secondary) !important;
}

/* Text labels - white in dark mode, black in light mode */
[data-theme="dark"] text {
  fill: #ffffff !important;
  stroke: none !important;
  stroke-width: 0 !important;
}

[data-theme="light"] text {
  fill: #000000 !important;
  stroke: none !important;
  stroke-width: 0 !important;
}

/* Connection lines - make flows and usages white in dark mode, black in light mode */
[data-theme="dark"] .djs-connection path {
  stroke: #ffffff !important;
}

[data-theme="light"] .djs-connection path {
  stroke: #000000 !important;
}

/* Specifically target FPB flows and usages */
[data-theme="dark"] .djs-connection[data-element-id*="Flow"] path,
[data-theme="dark"] .djs-connection[data-element-id*="Usage"] path {
  stroke: #ffffff !important;
}

[data-theme="light"] .djs-connection[data-element-id*="Flow"] path,
[data-theme="light"] .djs-connection[data-element-id*="Usage"] path {
  stroke: #000000 !important;
}

/* Arrow markers should also be white - comprehensive targeting */
[data-theme="dark"] .djs-connection marker path,
[data-theme="dark"] .djs-connection marker polygon,
[data-theme="dark"] defs marker path,
[data-theme="dark"] defs marker polygon,
[data-theme="dark"] marker path,
[data-theme="dark"] marker polygon,
[data-theme="dark"] svg defs marker path,
[data-theme="dark"] svg defs marker polygon {
  fill: #ffffff !important;
  stroke: #ffffff !important;
}

/* Target all SVG markers in dark mode */
[data-theme="dark"] svg marker > * {
  fill: #ffffff !important;
  stroke: #ffffff !important;
}

/* Target markers by ID patterns (FPB likely uses specific marker IDs) */
[data-theme="dark"] marker[id*="arrow"] path,
[data-theme="dark"] marker[id*="arrow"] polygon,
[data-theme="dark"] marker[id*="end"] path,
[data-theme="dark"] marker[id*="end"] polygon,
[data-theme="dark"] marker[id*="start"] path,
[data-theme="dark"] marker[id*="start"] polygon {
  fill: #ffffff !important;
  stroke: #ffffff !important;
}

/* SystemLimit dashed borders - keep default behavior (user prefers black for distinction) */

/* Grid styling for dark mode - try multiple selectors to catch the grid */
[data-theme="dark"] .djs-grid {
  opacity: 0.1 !important;
}

[data-theme="dark"] .djs-grid circle {
  fill: #666666 !important;
  opacity: 0.3 !important;
}

/* Try targeting grid pattern elements directly */
[data-theme="dark"] pattern circle {
  fill: #444444 !important;
  opacity: 0.2 !important;
}

[data-theme="dark"] pattern[id*="grid"] circle,
[data-theme="dark"] pattern[id*="dot"] circle {
  fill: #555555 !important;
  opacity: 0.15 !important;
}

/* Target SVG defs patterns */
[data-theme="dark"] defs pattern circle {
  fill: #444444 !important;
  opacity: 0.2 !important;
}

/* Grid background styling */
[data-theme="dark"] rect[fill^="url(#grid"],
[data-theme="dark"] rect[fill^="url(#dot"] {
  opacity: 0.1 !important;
}

/* Alternative: hide grid completely in dark mode if too distracting */
/* [data-theme="dark"] .djs-grid,
[data-theme="dark"] pattern[id*="grid"],
[data-theme="dark"] pattern[id*="dot"],
[data-theme="dark"] rect[fill^="url(#grid"],
[data-theme="dark"] rect[fill^="url(#dot"] {
  display: none !important;
} */

/* Tooltips and overlays */
[data-theme="dark"] .djs-tooltip {
  background: var(--fpb-tooltip-bg) !important;
  color: var(--fpb-tooltip-text) !important;
}

/* Fix for all drop feedback in dark mode */

/* Legal drop feedback (green) */
[data-theme="dark"] .djs-shape.connect-ok .djs-visual > :nth-child(1) {
  fill: #1a3d1a !important; /* dark green instead of light green */
}

/* Illegal drop feedback (red) */
[data-theme="dark"] .djs-shape.connect-not-ok .djs-visual > :nth-child(1),
[data-theme="dark"] .djs-shape.drop-not-ok .djs-visual > :nth-child(1) {
  fill: #3d1a1a !important; /* dark red instead of light red */
}

/* New parent feedback (blue) */
[data-theme="dark"] .djs-shape.new-parent .djs-visual > :nth-child(1) {
  fill: #1a1a3d !important; /* dark blue instead of light blue */
}

/* Frame/SystemLimit specific - keep transparent but show colored border */
[data-theme="dark"] .djs-frame.connect-ok .djs-visual > :nth-child(1) {
  fill: none !important; /* Keep SystemLimit transparent */
  stroke: #4ade80 !important; /* green border for allowed */
}

[data-theme="dark"] .djs-frame.connect-not-ok .djs-visual > :nth-child(1),
[data-theme="dark"] .djs-frame.drop-not-ok .djs-visual > :nth-child(1) {
  stroke: #ff6b6d !important; /* red border for not allowed */
  fill: none !important; /* Keep SystemLimit transparent */
}

[data-theme="dark"] .djs-frame.new-parent .djs-visual > :nth-child(1) {
  fill: none !important; /* Keep SystemLimit transparent */
  stroke: #60a5fa !important; /* blue border for new parent */
}

[data-theme="dark"] svg.drop-not-ok {
  background: #2a1f1f !important; /* dark red canvas background */
}

[data-theme="dark"] svg.new-parent {
  background: #1f1f2a !important; /* dark blue */
}

/* Fix white flash when dropping - try all possible combinations */
[data-theme="dark"] .djs-shape.drop-ok .djs-visual > :nth-child(1),
[data-theme="dark"] .djs-frame.drop-ok .djs-visual > :nth-child(1),
[data-theme="dark"] .djs-shape.drop-ok .djs-visual rect,
[data-theme="dark"] .djs-frame.drop-ok .djs-visual rect {
  fill: var(--fpb-bg-canvas) !important;
  background: var(--fpb-bg-canvas) !important;
}

/* Target SystemLimit specifically during drop */
[data-theme="dark"] .djs-shape.drop-ok,
[data-theme="dark"] .djs-frame.drop-ok {
  background: var(--fpb-bg-canvas) !important;
}

/* More aggressive drop-ok targeting */
[data-theme="dark"] .drop-ok .djs-visual rect,
[data-theme="dark"] .drop-ok rect {
  fill: var(--fpb-bg-canvas) !important;
}

/* Canvas drop zone background */
[data-theme="dark"] svg.drop-ok {
  background: var(--fpb-bg-canvas) !important;
}

/* SystemLimit specific drop feedback fix - more targeted approach */
[data-theme="dark"] .djs-element[data-element-id*="SystemLimit"] rect {
  fill: none !important;
}

[data-theme="dark"] .djs-shape[data-element-id*="SystemLimit"] rect,
[data-theme="dark"] .djs-frame[data-element-id*="SystemLimit"] rect {
  fill: none !important;
}

/* Override white fills specifically for SystemLimit during all states */
[data-theme="dark"] [data-element-id*="SystemLimit"] rect[fill="white"],
[data-theme="dark"] [data-element-id*="SystemLimit"] rect[fill="#ffffff"],
[data-theme="dark"] [data-element-id*="SystemLimit"] rect[fill="#FFFFFF"] {
  fill: none !important;
}

/* Container background during drop - but keep SystemLimit transparent */
[data-theme="dark"] [data-element-id*="SystemLimit"] *[style*="background: white"],
[data-theme="dark"] [data-element-id*="SystemLimit"] *[style*="background:#ffffff"] {
  background: transparent !important;
}

/* Very specific: SystemLimit rects should never have any fill */
[data-theme="dark"] g[data-element-id*="SystemLimit"] rect {
  fill: none !important;
  background: transparent !important;
}

/* Only target drag preview elements, not actual diagram elements */
[data-theme="dark"] .djs-shape-preview rect {
  fill: var(--fpb-bg-canvas) !important;
}

/* Create shape preview during drag from palette */
[data-theme="dark"] .djs-drag-preview rect {
  fill: var(--fpb-bg-canvas) !important;
}

/* Force canvas background for all diagram containers */
[data-theme="dark"] .djs-container {
  background: var(--fpb-bg-canvas) !important;
}

[data-theme="dark"] .djs-container canvas {
  background: var(--fpb-bg-canvas) !important;
}

/* Fix palette icons in dark mode - replace black strokes with white */
[data-theme="dark"] .palette-icon-space-tool {
  background: url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2246%22%20height%3D%2246%22%20version%3D%221.1%22%3E%0D%0A%20%20%3Cpath%20d%3D%22m%2030.041588%2C11.432085%20v%204.852906%20H%2017.492385%20v%20-4.852906%20c%200%2C-2.2528678%20-1.330189%2C-3.3810928%20-2.108205%2C-1.7881133%20l%20-4.428255%2C9.0674193%20c%20-0.4823%2C0.987566%20-0.4823%2C2.588555%200%2C3.576119%20l%204.428255%2C9.067418%20c%200.777963%2C1.592982%202.108205%2C0.464757%202.108205%2C-1.78811%20v%20-4.852802%20h%2012.549203%20v%204.852906%20c%200%2C2.252868%201.33019%2C3.381093%202.108205%2C1.788113%20l%204.428257%2C-9.067419%20c%200.482293%2C-0.987566%200.482293%2C-2.588555%200%2C-3.576119%20L%2032.149793%2C9.6440784%20C%2031.371827%2C8.0509922%2030.041588%2C9.1792172%2030.041588%2C11.432085%20Z%22%20stroke%3D%22white%22%0D%0A%20%20stroke-width%3D%221%22%20fill%3D%22none%22%20%2F%3E%0D%0A%0D%0A%3Crect%20x%3D%225.4924641%22%20y%3D%222.018292%22%20width%3D%223.3449237%22%20height%3D%2238.690731%22%20fill%3D%22white%22%2F%3E%0D%0A%3Crect%20x%3D%2239.875587%22%20y%3D%222.018292%22%20width%3D%223.3449237%22%20height%3D%2238.690731%22%20fill%3D%22white%22%2F%3E%0D%0A%3C%2Fsvg%3E') !important;
}

[data-theme="dark"] .palette-icon-lasso-tool {
  background: url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2246%22%20height%3D%2246%22%20version%3D%221.1%22%3E%0D%0A%20%20%3Cpath%20d%3D%22m%2042.286345%2C11.5211%200.02955%2C-2.970552%20C%2042.474101%2C5.6223645%2042.440653%2C5.5203289%2039.628173%2C5.5477006%20L%207.0209823%2C5.1601153%206.0736302%2C5.1228564%20C%204.3963535%2C5.1490502%204.4513937%2C5.0955101%204.2741756%2C8.0983671%20L%203.9787277%2C37.803885%20c%20-0.025955%2C2.40757%200.2907696%2C2.871851%202.6877259%2C3.002843%20l%2032.6071924%2C0.387586%20c%202.568129%2C-0.01123%202.656841%2C-0.0081%202.746796%2C-2.93825%20z%20M%209.5425089%2C24.872316%209.6680742%2C12.247471%20c%200.0061%2C-0.615183%200.4673238%2C-1.108534%201.0300528%2C-1.101846%20l%2014.265647%2C0.16957%20c%200.562729%2C0.0067%201.014014%2C0.510884%201.007895%2C1.126067%20l%20-0.125565%2C12.624846%20c%20-0.0061%2C0.615183%20-0.467325%2C1.108534%20-1.030054%2C1.101846%20L%2010.550403%2C25.998384%20C%209.9876752%2C25.991684%209.5363891%2C25.487498%209.5425089%2C24.872316%20Z%20m%2027.0840241%2C9.234643%20c%20-0.0061%2C0.615183%20-0.467324%2C1.108533%20-1.030053%2C1.101845%20L%2021.330833%2C35.039236%20c%20-0.562729%2C-0.0067%20-1.014014%2C-0.510887%20-1.007894%2C-1.12607%20l%200.04801%2C-4.827147%206.113849%2C0.07268%20c%201.125542%2C0.01338%202.047871%2C-0.973231%202.060107%2C-2.203688%20l%200.06648%2C-6.683743%207.132824%2C0.08478%20c%200.562729%2C0.0067%201.014013%2C0.510886%201.007894%2C1.126069%20z%22%20stroke%3D%22white%22%0D%0A%20%20stroke-width%3D%221%22%20fill%3D%22none%22%20%2F%3E%0D%0A%3C%2Fsvg%3E') !important;
}

[data-theme="dark"] .palette-icon-hand-tool {
  background: url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2246%22%20height%3D%2246%22%20version%3D%221.1%22%3E%0D%0A%20%20%3Cpath%20d%3D%22m%2036.34832%2C13.218928%20c%20-1.605184%2C-0.02974%20-2.919103%2C1.272682%20-2.919103%2C2.828077%20v%206.047541%20H%2032.856576%20V%209.875342%20c%200%2C-1.555395%20-1.313927%2C-2.8578247%20-2.919103%2C-2.8280767%20-1.555507%2C0.02883%20-2.807297%2C1.2594357%20-2.807297%2C2.7732947%20V%2022.094546%20H%2026.557534%20V%207.1709053%20c%200%2C-1.5553988%20-1.313921%2C-2.8578246%20-2.919103%2C-2.8280766%20-1.555502%2C0.02883%20-2.807295%2C1.2594362%20-2.807295%2C2.7732953%20V%2022.094546%20H%2020.258497%20V%209.944689%20c%200%2C-1.555398%20-1.313922%2C-2.8578309%20-2.919103%2C-2.8280794%20-1.555506%2C0.02883%20-2.807296%2C1.2594354%20-2.807296%2C2.7732944%20V%2026.254663%20L%2012.266735%2C23.236858%20C%2011.336694%2C21.997948%209.546048%2C21.723967%208.2670602%2C22.625029%206.9882825%2C23.526092%206.7055415%2C25.260816%207.6355785%2C26.499795%20l%208.9905185%2C11.976149%20a%203.4358396%2C3.3285378%200%200%200%202.778667%2C1.370802%20h%2014.14349%20c%201.59437%2C0%202.979301%2C-1.062634%203.344503%2C-2.566165%20l%201.89744%2C-7.812355%20a%2013.744146%2C13.314914%200%200%200%200.365346%2C-3.049423%20V%2015.992224%20c%205.9e-5%2C-1.51386%20-1.251722%2C-2.744448%20-2.807223%2C-2.773296%20z%22%20stroke%3D%22white%22%0D%0A%20%20stroke-width%3D%221%22%20fill%3D%22none%22%20%2F%3E%0D%0A%3C%2Fsvg%3E') !important;
}

/* Dark mode align tool icons */
[data-theme="dark"] .palette-icon-align-left {
  background: url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2246%22%20height%3D%2246%22%3E%3Cg%20stroke%3D%22white%22%20stroke-width%3D%221.5%22%20fill%3D%22none%22%3E%3Crect%20x%3D%228%22%20y%3D%228%22%20width%3D%2210%22%20height%3D%228%22/%3E%3Crect%20x%3D%228%22%20y%3D%2220%22%20width%3D%2210%22%20height%3D%228%22/%3E%3Crect%20x%3D%228%22%20y%3D%2232%22%20width%3D%2210%22%20height%3D%228%22/%3E%3Cline%20x1%3D%226%22%20y1%3D%224%22%20x2%3D%226%22%20y2%3D%2242%22%20stroke-width%3D%222%22/%3E%3C/g%3E%3C/svg%3E') !important;
}

[data-theme="dark"] .palette-icon-align-center {
  background: url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2246%22%20height%3D%2246%22%3E%3Cg%20stroke%3D%22white%22%20stroke-width%3D%221.5%22%20fill%3D%22none%22%3E%3Crect%20x%3D%2218%22%20y%3D%228%22%20width%3D%2210%22%20height%3D%228%22/%3E%3Crect%20x%3D%2218%22%20y%3D%2220%22%20width%3D%2210%22%20height%3D%228%22/%3E%3Crect%20x%3D%2218%22%20y%3D%2232%22%20width%3D%2210%22%20height%3D%228%22/%3E%3Cline%20x1%3D%2223%22%20y1%3D%224%22%20x2%3D%2223%22%20y2%3D%2242%22%20stroke-width%3D%222%22/%3E%3C/g%3E%3C/svg%3E') !important;
}

[data-theme="dark"] .palette-icon-align-right {
  background: url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2246%22%20height%3D%2246%22%3E%3Cg%20stroke%3D%22white%22%20stroke-width%3D%221.5%22%20fill%3D%22none%22%3E%3Crect%20x%3D%2228%22%20y%3D%228%22%20width%3D%2210%22%20height%3D%228%22/%3E%3Crect%20x%3D%2228%22%20y%3D%2220%22%20width%3D%2210%22%20height%3D%228%22/%3E%3Crect%20x%3D%2228%22%20y%3D%2232%22%20width%3D%2210%22%20height%3D%228%22/%3E%3Cline%20x1%3D%2240%22%20y1%3D%224%22%20x2%3D%2240%22%20y2%3D%2242%22%20stroke-width%3D%222%22/%3E%3C/g%3E%3C/svg%3E') !important;
}

[data-theme="dark"] .palette-icon-align-top {
  background: url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2246%22%20height%3D%2246%22%3E%3Cg%20stroke%3D%22white%22%20stroke-width%3D%221.5%22%20fill%3D%22none%22%3E%3Crect%20x%3D%228%22%20y%3D%228%22%20width%3D%228%22%20height%3D%2210%22/%3E%3Crect%20x%3D%2220%22%20y%3D%228%22%20width%3D%228%22%20height%3D%2210%22/%3E%3Crect%20x%3D%2232%22%20y%3D%228%22%20width%3D%228%22%20height%3D%2210%22/%3E%3Cline%20x1%3D%224%22%20y1%3D%226%22%20x2%3D%2242%22%20y2%3D%226%22%20stroke-width%3D%222%22/%3E%3C/g%3E%3C/svg%3E') !important;
}

[data-theme="dark"] .palette-icon-align-middle {
  background: url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2246%22%20height%3D%2246%22%3E%3Cg%20stroke%3D%22white%22%20stroke-width%3D%221.5%22%20fill%3D%22none%22%3E%3Crect%20x%3D%228%22%20y%3D%2218%22%20width%3D%228%22%20height%3D%2210%22/%3E%3Crect%20x%3D%2220%22%20y%3D%2218%22%20width%3D%228%22%20height%3D%2210%22/%3E%3Crect%20x%3D%2232%22%20y%3D%2218%22%20width%3D%228%22%20height%3D%2210%22/%3E%3Cline%20x1%3D%224%22%20y1%3D%2223%22%20x2%3D%2242%22%20y2%3D%2223%22%20stroke-width%3D%222%22/%3E%3C/g%3E%3C/svg%3E') !important;
}

[data-theme="dark"] .palette-icon-align-bottom {
  background: url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2246%22%20height%3D%2246%22%3E%3Cg%20stroke%3D%22white%22%20stroke-width%3D%221.5%22%20fill%3D%22none%22%3E%3Crect%20x%3D%228%22%20y%3D%2228%22%20width%3D%228%22%20height%3D%2210%22/%3E%3Crect%20x%3D%2220%22%20y%3D%2228%22%20width%3D%228%22%20height%3D%2210%22/%3E%3Crect%20x%3D%2232%22%20y%3D%2228%22%20width%3D%228%22%20height%3D%2210%22/%3E%3Cline%20x1%3D%224%22%20y1%3D%2240%22%20x2%3D%2242%22%20y2%3D%2240%22%20stroke-width%3D%222%22/%3E%3C/g%3E%3C/svg%3E') !important;
}

[data-theme="dark"] .palette-icon-distribute-horizontal {
  background: url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2246%22%20height%3D%2246%22%3E%3Cg%20stroke%3D%22white%22%20stroke-width%3D%221.5%22%20fill%3D%22none%22%3E%3Crect%20x%3D%226%22%20y%3D%2218%22%20width%3D%226%22%20height%3D%2210%22/%3E%3Crect%20x%3D%2220%22%20y%3D%2218%22%20width%3D%226%22%20height%3D%2210%22/%3E%3Crect%20x%3D%2234%22%20y%3D%2218%22%20width%3D%226%22%20height%3D%2210%22/%3E%3Cline%20x1%3D%2215%22%20y1%3D%2223%22%20x2%3D%2217%22%20y2%3D%2223%22%20stroke-width%3D%221%22/%3E%3Cline%20x1%3D%2229%22%20y1%3D%2223%22%20x2%3D%2231%22%20y2%3D%2223%22%20stroke-width%3D%221%22/%3E%3C/g%3E%3C/svg%3E') !important;
}

[data-theme="dark"] .palette-icon-distribute-vertical {
  background: url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2246%22%20height%3D%2246%22%3E%3Cg%20stroke%3D%22white%22%20stroke-width%3D%221.5%22%20fill%3D%22none%22%3E%3Crect%20x%3D%2218%22%20y%3D%226%22%20width%3D%2210%22%20height%3D%226%22/%3E%3Crect%20x%3D%2218%22%20y%3D%2220%22%20width%3D%2210%22%20height%3D%226%22/%3E%3Crect%20x%3D%2218%22%20y%3D%2234%22%20width%3D%2210%22%20height%3D%226%22/%3E%3Cline%20x1%3D%2223%22%20y1%3D%2215%22%20x2%3D%2223%22%20y2%3D%2217%22%20stroke-width%3D%221%22/%3E%3Cline%20x1%3D%2223%22%20y1%3D%2229%22%20x2%3D%2223%22%20y2%3D%2231%22%20stroke-width%3D%221%22/%3E%3C/g%3E%3C/svg%3E') !important;
}

/* Context pad icons */
[data-theme="dark"] .context-pad-icon-remove {
  background: url('data:image/svg+xml,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%3F%3E%0D%0A%3Csvg%20id%3D%22SVGRoot%22%20version%3D%221.1%22%20viewBox%3D%220%200%2025%2025%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0D%0A%20%3Cg%20fill%3D%22none%22%20stroke%3D%22white%22%20stroke-miterlimit%3D%222.2%22%3E%0D%0A%20%20%3Cpath%20d%3D%22m1.8993%2023.429%2020.434-21.361%22%20stroke-width%3D%221.3439%22%2F%3E%0D%0A%20%20%3Cpath%20d%3D%22m23.142%2023.647-21.183-21.152%22%20stroke-width%3D%221.3616%22%2F%3E%0D%0A%20%3C%2Fg%3E%0D%0A%3C%2Fsvg%3E') !important;
}

[data-theme="dark"] .context-pad-icon-connect {
  background: url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20stroke%3D%22white%22%20stroke-width%3D%221.5%22%20width%3D%2246%22%20height%3D%2246%22%3E%3Cline%20x1%3D%2215%22%20y1%3D%225%22%20x2%3D%225%22%20y2%3D%2215%22%2F%3E%3C%2Fsvg%3E') !important;
}

/* FPB Element icons with black strokes */
[data-theme="dark"] .fpb-element-icon-product {
  background: url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2246%22%20height%3D%2246%22%20fill%3D%22%236e9ad1%22%20stroke%3D%22white%22%20stroke-width%3D%221.5%22%3E%0D%0A%3Cpolygon%20points%3D%22%0D%0A23%2C2%20%0D%0A43%2C%2023%0D%0A23%2C%2043%0D%0A2%2C23%0D%0A23%2C2%22%20%0D%0A%2F%3E%0D%0A%3C%2Fsvg%3E') !important;
}

[data-theme="dark"] .fpb-element-icon-energy {
  background: url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2246%22%20height%3D%2246%22%20fill%3D%22%233050a2%22%20stroke%3D%22white%22%20stroke-width%3D%221.5%22%3E%0D%0A%3Cpolygon%20points%3D%22%0D%0A13%2C5.5%0D%0A33%2C5.5%0D%0A43%2C23%0D%0A33%2C40.5%0D%0A13%2C40.5%0D%0A3%2C23%0D%0A13%2C5.5%22%20%0D%0A%2F%3E%0D%0A%3C%2Fsvg%3E') !important;
}

[data-theme="dark"] .fpb-element-icon-information {
  background: url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20%20width%3D%2246%22%20height%3D%2246%22%20fill%3D%22%23ed2028%22%20stroke%3D%22white%22%20stroke-width%3D%221.5%22%3E%0D%0A%20%20%20%3Ccircle%20cx%3D%2223%22%20cy%3D%2223%22%20r%3D%2220%22%2F%3E%0D%0A%3C%2Fsvg%3E') !important;
}

[data-theme="dark"] .fpb-element-icon-processoperator {
  background: url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2246%22%20height%3D%2246%22%20fill%3D%22%2313ae4d%22%20stroke%3D%22white%22%20stroke-width%3D%221.5%22%3E%0D%0A%20%20%20%3Crect%20x%3D%222%22%20y%3D%225%22%20width%3D%2242%22%20height%3D%2225%22%2F%3E%0D%0A%3C%2Fsvg%3E') !important;
}

[data-theme="dark"] .fpb-element-icon-technicalresource {
  background: url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2246%22%20height%3D%2246%22%20fill%3D%22%23888889%22%20stroke%3D%22white%22%20stroke-width%3D%221.5%22%3E%0D%0A%20%20%3Crect%20x%3D%222%22%20y%3D%2210%22%20rx%3D%229%22%20ry%3D%2211%22%20width%3D%2242%22%20height%3D%2220%22%2F%3E%0D%0A%3C%2Fsvg%3E') !important;
}

[data-theme="dark"] .icon-fpb-systemlimit {
  filter: invert(1) !important;
}

/* Flow icons */
[data-theme="dark"] .fpb-element-icon-flow,
[data-theme="dark"] .fpb-element-icon-alternativeflow,
[data-theme="dark"] .fpb-element-icon-parallelflow,
[data-theme="dark"] .fpb-element-icon-usage {
  filter: invert(1) !important;
}

/* SystemLimit shapes - target by fill="none" (this actually works!) */
[data-theme="dark"] rect[fill="none"] {
  stroke: #cccccc !important;
}

[data-theme="light"] rect[fill="none"] {
  stroke: black !important;
}